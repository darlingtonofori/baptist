{% extends "base.html" %}

{% block content %}
<div class="forum-container">
    {% if current_user.is_authenticated %}
    <div class="post-form">
        <h3>Create New Thread</h3>
        <form id="create-post" enctype="multipart/form-data">
            <input type="text" name="title" placeholder="Title (optional)">
            <textarea name="content" placeholder="Your message..." required></textarea>
            <div class="file-upload">
                <label for="post-image">Upload Image (PNG, JPG, GIF):</label>
                <input type="file" id="post-image" name="image" accept="image/png, image/jpeg, image/gif">
            </div>
            <button type="submit">Post</button>
            <div id="post-error" class="error-message"></div>
        </form>
    </div>
    {% endif %}
    
    <div class="posts-list" id="posts-list">
        {% if not posts %}
            <div class="no-posts">No posts yet. Be the first to post!</div>
        {% else %}
            {% for post in posts %}
            <div class="post" data-post-id="{{ post.id }}">
                <!-- Your existing post template -->
            </div>
            {% endfor %}
        {% endif %}
    </div>
</div>

<script>
const CURRENT_USER = {
    is_authenticated: {{ 'true' if current_user.is_authenticated else 'false' }},
    is_admin: {{ 'true' if current_user.is_authenticated and current_user.is_admin else 'false' }},
    id: {{ current_user.id if current_user.is_authenticated else 'null' }}
};
</script>
<script src="{{ url_for('static', filename='js/realtime.js') }}"></script>
{% endblock %}
